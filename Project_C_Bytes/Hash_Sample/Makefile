COMPILER=gcc
CFLAGS=-lcrypto -lm
CFLAGS_DEBUG=-g -O0 -lcrypto -lm
PROJECT_NAME=hash

ifeq ($(OS),Windows_NT)
	TARGET_FILE_MD5=$(PROJECT_NAME)_md5.exe
	TARGET_FILE_SHA256=$(PROJECT_NAME)_sha256.exe
else
UNAME=${shell uname}
ifeq ($(UNAME),Darwin)
	TARGET_FILE_MD5=$(PROJECT_NAME)_for_mac_MD5
	TARGET_FILE_SHA256=$(PROJECT_NAME)_for_mac_MD5
	INCLUDE=-I/usr/local/Cellar/openssl@1.1/1.1.1g/include
	LIBS=-L/usr/local/Cellar/openssl@1.1/1.1.1g/lib
else
ifeq ($(UNAME),Linux)
	TARGET_FILE_MD5=$(PROJECT_NAME)_for_linux_MD5
	TARGET_FILE_SHA256=$(PROJECT_NAME)_for_linux_SHA256
else
	TARGET_FILE_MD5=$(PROJECT_NAME)_MD5
	TARGET_FILE_SHA256=$(PROJECT_NAME)_SHA246
endif
endif
endif

SOURCE_FILE_MD5=hash_md5.c
SOURCE_FILE_SHA256=hash_sha256.c

all:	$(TARGET_FILE_MD5) $(TARGET_FILE_SHA256)

$(TARGET_FILE_MD5):	$(SOURCE_FILE_MD5)
	$(COMPILER) -o$(TARGET_FILE_MD5) $(INCLUDE) $(LIBS) $(SOURCE_FILE_MD5) $(CFLAGS)

$(TARGET_FILE_SHA256):	$(SOURCE_FILE_SHA256)
	$(COMPILER) -o$(TARGET_FILE_SHA256) $(INCLUDE) $(LIBS) $(SOURCE_FILE_SHA256) $(CFLAGS)

debug:	$(SOURCE_FILE_MD5) $(SOURCE_FILE_SHA256)
	$(COMPILER) -o$(TARGET_FILE_MD5)_debug $(INCLUDE) $(LIBS) $(SOURCE_FILE_MD5) $(CFLAGS_DEBUG)
	$(COMPILER) -o$(TARGET_FILE_SHA256)_debug $(INCLUDE) $(LIBS) $(SOURCE_FILE_SHA256) $(CFLAGS_DEBUG)

clean:
	rm $(TARGET_FILE_MD5)
	rm $(TARGET_FILE_SHA256)
